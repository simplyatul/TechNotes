[Fri Jan 31 05:07:46] [vagrant@ubuntu-jammy] [/shared-with-host]#
[Fri Jan 31 05:07:48] [vagrant@ubuntu-jammy] [/shared-with-host]#
[Fri Jan 31 05:07:49] [vagrant@ubuntu-jammy] [/shared-with-host]#
ls
0-bk-0.log      28-01-2025.log  app-with-labels.yaml      cilium-kind-config.yaml    custom-ns.yaml  k8s                                  pod-w-host-network.yaml   simple-nginx-dep-n-srv-w-np.yaml  simple-nginx-pod-n-srv.yaml
06-01-2025.log  29-01-2025.log  atrivial-app-simple.yaml  cilium-linux-amd64.tar.gz  eBPF            k8s_aliases                          pod-wo-host-network.yaml  simple-nginx-ingress.yaml         t0.log
27-01-2025.log  Dockerfile      cilium                    code                       envoy-gateway   kind-local-k8s-cluster-baremin.yaml  s.sh                      simple-nginx-pod-n-srv-w-np.yaml
[Fri Jan 31 05:07:53] [vagrant@ubuntu-jammy] [/shared-with-host]#
cd envoy-gateway/HTTPRoute/
[Fri Jan 31 05:07:57] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
kga
kubectl get all
E0131 05:07:59.509889   31533 memcache.go:265] "Unhandled Error" err="couldn't get current server API group list: Get \"http://localhost:8080/api?timeout=32s\": dial tcp 127.0.0.1:8080: connect: connection refused"
E0131 05:07:59.511764   31533 memcache.go:265] "Unhandled Error" err="couldn't get current server API group list: Get \"http://localhost:8080/api?timeout=32s\": dial tcp 127.0.0.1:8080: connect: connection refused"
E0131 05:07:59.513609   31533 memcache.go:265] "Unhandled Error" err="couldn't get current server API group list: Get \"http://localhost:8080/api?timeout=32s\": dial tcp 127.0.0.1:8080: connect: connection refused"
E0131 05:07:59.515393   31533 memcache.go:265] "Unhandled Error" err="couldn't get current server API group list: Get \"http://localhost:8080/api?timeout=32s\": dial tcp 127.0.0.1:8080: connect: connection refused"
E0131 05:07:59.517041   31533 memcache.go:265] "Unhandled Error" err="couldn't get current server API group list: Get \"http://localhost:8080/api?timeout=32s\": dial tcp 127.0.0.1:8080: connect: connection refused"
The connection to the server localhost:8080 was refused - did you specify the right host or port?
[Fri Jan 31 05:07:59] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
cat kin
cat: kin: No such file or directory
[Fri Jan 31 05:08:02] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
[Fri Jan 31 05:08:02] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
cd ..
[Fri Jan 31 05:08:07] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway]#
[Fri Jan 31 05:08:07] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway]#
ls
HTTPRoute  capture-envoy-data.sh  disable-prometheus.yaml  kind-config.yaml  quickstart.yaml  tls-passthrough
[Fri Jan 31 05:08:07] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway]#
cat kind-config.yaml
# kind create cluster --config=kind-config.yaml --name env-gw
# kind delete cluster --name env-gw

# env-gw => Envoy Gateway => https://gateway.envoyproxy.io/docs/tasks/quickstart/

kind: Cluster
apiVersion: kind.x-k8s.io/v1alpha4
nodes:
- role: control-plane
- role: worker
- role: worker
[Fri Jan 31 05:08:13] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway]#
kind create cluster --config=kind-config.yaml --name env-gw
Creating cluster "env-gw" ...
 ‚úì Ensuring node image (kindest/node:v1.31.0) üñº
 ‚úì Preparing nodes üì¶ üì¶ üì¶
 ‚úì Writing configuration üìú
 ‚úì Starting control-plane üïπÔ∏è
 ‚úì Installing CNI üîå
 ‚úì Installing StorageClass üíæ
 ‚úì Joining worker nodes üöú
Set kubectl context to "kind-env-gw"
You can now use your cluster with:

kubectl cluster-info --context kind-env-gw

Thanks for using kind! üòä
[Fri Jan 31 05:08:53] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway]#
[Fri Jan 31 05:08:53] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway]#
kga -A
kubectl get all
NAMESPACE            NAME                                               READY   STATUS              RESTARTS   AGE
kube-system          pod/coredns-6f6b679f8f-sx85m                       0/1     Pending             0          10s
kube-system          pod/coredns-6f6b679f8f-xkcsr                       0/1     Pending             0          10s
kube-system          pod/etcd-env-gw-control-plane                      1/1     Running             0          15s
kube-system          pod/kindnet-97z4h                                  1/1     Running             0          10s
kube-system          pod/kindnet-qwlgm                                  0/1     ContainerCreating   0          5s
kube-system          pod/kindnet-xl49m                                  0/1     ContainerCreating   0          5s
kube-system          pod/kube-apiserver-env-gw-control-plane            1/1     Running             0          15s
kube-system          pod/kube-controller-manager-env-gw-control-plane   1/1     Running             0          15s
kube-system          pod/kube-proxy-dgk2w                               1/1     Running             0          5s
kube-system          pod/kube-proxy-gt7tj                               1/1     Running             0          5s
kube-system          pod/kube-proxy-ttt7h                               1/1     Running             0          10s
kube-system          pod/kube-scheduler-env-gw-control-plane            1/1     Running             0          15s
local-path-storage   pod/local-path-provisioner-57c5987fd4-9ncdn        0/1     Pending             0          10s

NAMESPACE     NAME                 TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)                  AGE
default       service/kubernetes   ClusterIP   10.96.0.1    <none>        443/TCP                  16s
kube-system   service/kube-dns     ClusterIP   10.96.0.10   <none>        53/UDP,53/TCP,9153/TCP   15s

NAMESPACE     NAME                        DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR            AGE
kube-system   daemonset.apps/kindnet      3         3         1       3            1           kubernetes.io/os=linux   14s
kube-system   daemonset.apps/kube-proxy   3         3         3       3            3           kubernetes.io/os=linux   15s

NAMESPACE            NAME                                     READY   UP-TO-DATE   AVAILABLE   AGE
kube-system          deployment.apps/coredns                  0/2     2            0           15s
local-path-storage   deployment.apps/local-path-provisioner   0/1     1            0           13s

NAMESPACE            NAME                                                DESIRED   CURRENT   READY   AGE
kube-system          replicaset.apps/coredns-6f6b679f8f                  2         2         0       10s
local-path-storage   replicaset.apps/local-path-provisioner-57c5987fd4   1         1         0       10s
[Fri Jan 31 05:08:57] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway]#
kga -A
kubectl get all
NAMESPACE            NAME                                               READY   STATUS    RESTARTS   AGE
kube-system          pod/coredns-6f6b679f8f-sx85m                       1/1     Running   0          19s
kube-system          pod/coredns-6f6b679f8f-xkcsr                       1/1     Running   0          19s
kube-system          pod/etcd-env-gw-control-plane                      1/1     Running   0          24s
kube-system          pod/kindnet-97z4h                                  1/1     Running   0          19s
kube-system          pod/kindnet-qwlgm                                  1/1     Running   0          14s
kube-system          pod/kindnet-xl49m                                  1/1     Running   0          14s
kube-system          pod/kube-apiserver-env-gw-control-plane            1/1     Running   0          24s
kube-system          pod/kube-controller-manager-env-gw-control-plane   1/1     Running   0          24s
kube-system          pod/kube-proxy-dgk2w                               1/1     Running   0          14s
kube-system          pod/kube-proxy-gt7tj                               1/1     Running   0          14s
kube-system          pod/kube-proxy-ttt7h                               1/1     Running   0          19s
kube-system          pod/kube-scheduler-env-gw-control-plane            1/1     Running   0          24s
local-path-storage   pod/local-path-provisioner-57c5987fd4-9ncdn        1/1     Running   0          19s

NAMESPACE     NAME                 TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)                  AGE
default       service/kubernetes   ClusterIP   10.96.0.1    <none>        443/TCP                  25s
kube-system   service/kube-dns     ClusterIP   10.96.0.10   <none>        53/UDP,53/TCP,9153/TCP   24s

NAMESPACE     NAME                        DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR            AGE
kube-system   daemonset.apps/kindnet      3         3         3       3            3           kubernetes.io/os=linux   23s
kube-system   daemonset.apps/kube-proxy   3         3         3       3            3           kubernetes.io/os=linux   24s

NAMESPACE            NAME                                     READY   UP-TO-DATE   AVAILABLE   AGE
kube-system          deployment.apps/coredns                  2/2     2            2           24s
local-path-storage   deployment.apps/local-path-provisioner   1/1     1            1           22s

NAMESPACE            NAME                                                DESIRED   CURRENT   READY   AGE
kube-system          replicaset.apps/coredns-6f6b679f8f                  2         2         2       19s
local-path-storage   replicaset.apps/local-path-provisioner-57c5987fd4   1         1         1       19s
[Fri Jan 31 05:09:06] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway]#
[Fri Jan 31 05:09:08] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway]#
[Fri Jan 31 05:09:08] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway]#
[Fri Jan 31 05:09:08] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway]#
cd HTTPRoute/
[Fri Jan 31 05:09:17] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
[Fri Jan 31 05:09:17] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
ls
Gateway.yaml  backend-http-service.yaml
[Fri Jan 31 05:09:19] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
helm install eg oci://docker.io/envoyproxy/gateway-helm --version v1.2.6 -n envoy-gateway-system --create-namespace
Pulled: docker.io/envoyproxy/gateway-helm:v1.2.6
Digest: sha256:89ff3ccd206a66f51adfd02c75436fa6b58037ab15a8049c36f7eb10227ce2a4
NAME: eg
LAST DEPLOYED: Fri Jan 31 05:09:28 2025
NAMESPACE: envoy-gateway-system
STATUS: deployed
REVISION: 1
TEST SUITE: None
NOTES:
**************************************************************************
*** PLEASE BE PATIENT: Envoy Gateway may take a few minutes to install ***
**************************************************************************

Envoy Gateway is an open source project for managing Envoy Proxy as a standalone or Kubernetes-based application gateway.

Thank you for installing Envoy Gateway! üéâ

Your release is named: eg. üéâ

Your release is in namespace: envoy-gateway-system. üéâ

To learn more about the release, try:

  $ helm status eg -n envoy-gateway-system
  $ helm get all eg -n envoy-gateway-system

To have a quickstart of Envoy Gateway, please refer to https://gateway.envoyproxy.io/latest/tasks/quickstart.

To get more details, please visit https://gateway.envoyproxy.io and https://github.com/envoyproxy/gateway.
[Fri Jan 31 05:09:49] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
[Fri Jan 31 05:10:32] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
[Fri Jan 31 05:10:32] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
kag -A
[Fri Jan 31 05:10:32] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
kag -A
Command 'kag' not found, did you mean:
  command 'kig' from snap kig (23.08.3)
  command 'kmag' from snap kmag (23.08.4)
  command 'kak' from snap kakoune (v2023.08.05)
  command 'kar' from deb sra-toolkit (2.11.3+dfsg-1ubuntu1)
  command 'kig' from deb kig (4:21.12.3-0ubuntu1)
  command 'kas' from deb kas (2.6.3-2)
  command 'kak' from deb kakoune (2020.09.01-3)
  command 'mag' from deb texlive-binaries (2021.20210626.59705-1ubuntu0.2)
  command 'ag' from deb silversearcher-ag (2.2.0+git20200805-1)
  command 'jag' from deb jag (0.3.8-2)
  command 'kmag' from deb kmag (4:21.12.3-0ubuntu1)
See 'snap info <snapname>' for additional versions.
[Fri Jan 31 05:10:35] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
kga -A
[Fri Jan 31 05:10:35] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
kga -A
kubectl get all
NAMESPACE              NAME                                               READY   STATUS    RESTARTS   AGE
envoy-gateway-system   pod/envoy-gateway-5b47459c4d-g9v8w                 1/1     Running   0          51s
kube-system            pod/coredns-6f6b679f8f-sx85m                       1/1     Running   0          112s
kube-system            pod/coredns-6f6b679f8f-xkcsr                       1/1     Running   0          112s
kube-system            pod/etcd-env-gw-control-plane                      1/1     Running   0          117s
kube-system            pod/kindnet-97z4h                                  1/1     Running   0          112s
kube-system            pod/kindnet-qwlgm                                  1/1     Running   0          107s
kube-system            pod/kindnet-xl49m                                  1/1     Running   0          107s
kube-system            pod/kube-apiserver-env-gw-control-plane            1/1     Running   0          117s
kube-system            pod/kube-controller-manager-env-gw-control-plane   1/1     Running   0          117s
kube-system            pod/kube-proxy-dgk2w                               1/1     Running   0          107s
kube-system            pod/kube-proxy-gt7tj                               1/1     Running   0          107s
kube-system            pod/kube-proxy-ttt7h                               1/1     Running   0          112s
kube-system            pod/kube-scheduler-env-gw-control-plane            1/1     Running   0          117s
local-path-storage     pod/local-path-provisioner-57c5987fd4-9ncdn        1/1     Running   0          112s

NAMESPACE              NAME                    TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)                                   AGE
default                service/kubernetes      ClusterIP   10.96.0.1       <none>        443/TCP                                   118s
envoy-gateway-system   service/envoy-gateway   ClusterIP   10.96.197.132   <none>        18000/TCP,18001/TCP,18002/TCP,19001/TCP   51s
kube-system            service/kube-dns        ClusterIP   10.96.0.10      <none>        53/UDP,53/TCP,9153/TCP                    117s

NAMESPACE     NAME                        DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR            AGE
kube-system   daemonset.apps/kindnet      3         3         3       3            3           kubernetes.io/os=linux   116s
kube-system   daemonset.apps/kube-proxy   3         3         3       3            3           kubernetes.io/os=linux   117s

NAMESPACE              NAME                                     READY   UP-TO-DATE   AVAILABLE   AGE
envoy-gateway-system   deployment.apps/envoy-gateway            1/1     1            1           51s
kube-system            deployment.apps/coredns                  2/2     2            2           117s
local-path-storage     deployment.apps/local-path-provisioner   1/1     1            1           115s

NAMESPACE              NAME                                                DESIRED   CURRENT   READY   AGE
envoy-gateway-system   replicaset.apps/envoy-gateway-5b47459c4d            1         1         1       51s
kube-system            replicaset.apps/coredns-6f6b679f8f                  2         2         2       112s
local-path-storage     replicaset.apps/local-path-provisioner-57c5987fd4   1         1         1       112s
[Fri Jan 31 05:10:39] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
# AT: Install GatewayClass and Gateway
[Fri Jan 31 05:11:00] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
k apply -f Gateway.yaml
gatewayclass.gateway.networking.k8s.io/eg created
gateway.gateway.networking.k8s.io/eg created
[Fri Jan 31 05:11:07] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
kga -A
kubectl get all
NAMESPACE              NAME                                               READY   STATUS              RESTARTS   AGE
envoy-gateway-system   pod/envoy-default-eg-e41e7b31-594f564cb9-nn75s     0/2     ContainerCreating   0          3s
envoy-gateway-system   pod/envoy-gateway-5b47459c4d-g9v8w                 1/1     Running             0          82s
kube-system            pod/coredns-6f6b679f8f-sx85m                       1/1     Running             0          2m23s
kube-system            pod/coredns-6f6b679f8f-xkcsr                       1/1     Running             0          2m23s
kube-system            pod/etcd-env-gw-control-plane                      1/1     Running             0          2m28s
kube-system            pod/kindnet-97z4h                                  1/1     Running             0          2m23s
kube-system            pod/kindnet-qwlgm                                  1/1     Running             0          2m18s
kube-system            pod/kindnet-xl49m                                  1/1     Running             0          2m18s
kube-system            pod/kube-apiserver-env-gw-control-plane            1/1     Running             0          2m28s
kube-system            pod/kube-controller-manager-env-gw-control-plane   1/1     Running             0          2m28s
kube-system            pod/kube-proxy-dgk2w                               1/1     Running             0          2m18s
kube-system            pod/kube-proxy-gt7tj                               1/1     Running             0          2m18s
kube-system            pod/kube-proxy-ttt7h                               1/1     Running             0          2m23s
kube-system            pod/kube-scheduler-env-gw-control-plane            1/1     Running             0          2m28s
local-path-storage     pod/local-path-provisioner-57c5987fd4-9ncdn        1/1     Running             0          2m23s

NAMESPACE              NAME                                TYPE           CLUSTER-IP      EXTERNAL-IP   PORT(S)                                   AGE
default                service/kubernetes                  ClusterIP      10.96.0.1       <none>        443/TCP                                   2m29s
envoy-gateway-system   service/envoy-default-eg-e41e7b31   LoadBalancer   10.96.89.65     <pending>     80:31685/TCP                              3s
envoy-gateway-system   service/envoy-gateway               ClusterIP      10.96.197.132   <none>        18000/TCP,18001/TCP,18002/TCP,19001/TCP   82s
kube-system            service/kube-dns                    ClusterIP      10.96.0.10      <none>        53/UDP,53/TCP,9153/TCP                    2m28s

NAMESPACE     NAME                        DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR            AGE
kube-system   daemonset.apps/kindnet      3         3         3       3            3           kubernetes.io/os=linux   2m27s
kube-system   daemonset.apps/kube-proxy   3         3         3       3            3           kubernetes.io/os=linux   2m28s

NAMESPACE              NAME                                        READY   UP-TO-DATE   AVAILABLE   AGE
envoy-gateway-system   deployment.apps/envoy-default-eg-e41e7b31   0/1     1            0           3s
envoy-gateway-system   deployment.apps/envoy-gateway               1/1     1            1           82s
kube-system            deployment.apps/coredns                     2/2     2            2           2m28s
local-path-storage     deployment.apps/local-path-provisioner      1/1     1            1           2m26s

NAMESPACE              NAME                                                   DESIRED   CURRENT   READY   AGE
envoy-gateway-system   replicaset.apps/envoy-default-eg-e41e7b31-594f564cb9   1         1         0       3s
envoy-gateway-system   replicaset.apps/envoy-gateway-5b47459c4d               1         1         1       82s
kube-system            replicaset.apps/coredns-6f6b679f8f                     2         2         2       2m23s
local-path-storage     replicaset.apps/local-path-provisioner-57c5987fd4      1         1         1       2m23s
[Fri Jan 31 05:11:10] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
[Fri Jan 31 05:11:13] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
[Fri Jan 31 05:11:13] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
[Fri Jan 31 05:11:14] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
[Fri Jan 31 05:15:31] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
[Fri Jan 31 05:15:31] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
kga -A
kubectl get all
NAMESPACE              NAME                                               READY   STATUS    RESTARTS   AGE
envoy-gateway-system   pod/envoy-default-eg-e41e7b31-594f564cb9-nn75s     2/2     Running   0          4m27s
envoy-gateway-system   pod/envoy-gateway-5b47459c4d-g9v8w                 1/1     Running   0          5m46s
kube-system            pod/coredns-6f6b679f8f-sx85m                       1/1     Running   0          6m47s
kube-system            pod/coredns-6f6b679f8f-xkcsr                       1/1     Running   0          6m47s
kube-system            pod/etcd-env-gw-control-plane                      1/1     Running   0          6m52s
kube-system            pod/kindnet-97z4h                                  1/1     Running   0          6m47s
kube-system            pod/kindnet-qwlgm                                  1/1     Running   0          6m42s
kube-system            pod/kindnet-xl49m                                  1/1     Running   0          6m42s
kube-system            pod/kube-apiserver-env-gw-control-plane            1/1     Running   0          6m52s
kube-system            pod/kube-controller-manager-env-gw-control-plane   1/1     Running   0          6m52s
kube-system            pod/kube-proxy-dgk2w                               1/1     Running   0          6m42s
kube-system            pod/kube-proxy-gt7tj                               1/1     Running   0          6m42s
kube-system            pod/kube-proxy-ttt7h                               1/1     Running   0          6m47s
kube-system            pod/kube-scheduler-env-gw-control-plane            1/1     Running   0          6m52s
local-path-storage     pod/local-path-provisioner-57c5987fd4-9ncdn        1/1     Running   0          6m47s

NAMESPACE              NAME                                TYPE           CLUSTER-IP      EXTERNAL-IP   PORT(S)                                   AGE
default                service/kubernetes                  ClusterIP      10.96.0.1       <none>        443/TCP                                   6m53s
envoy-gateway-system   service/envoy-default-eg-e41e7b31   LoadBalancer   10.96.89.65     <pending>     80:31685/TCP                              4m27s
envoy-gateway-system   service/envoy-gateway               ClusterIP      10.96.197.132   <none>        18000/TCP,18001/TCP,18002/TCP,19001/TCP   5m46s
kube-system            service/kube-dns                    ClusterIP      10.96.0.10      <none>        53/UDP,53/TCP,9153/TCP                    6m52s

NAMESPACE     NAME                        DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR            AGE
kube-system   daemonset.apps/kindnet      3         3         3       3            3           kubernetes.io/os=linux   6m51s
kube-system   daemonset.apps/kube-proxy   3         3         3       3            3           kubernetes.io/os=linux   6m52s

NAMESPACE              NAME                                        READY   UP-TO-DATE   AVAILABLE   AGE
envoy-gateway-system   deployment.apps/envoy-default-eg-e41e7b31   1/1     1            1           4m27s
envoy-gateway-system   deployment.apps/envoy-gateway               1/1     1            1           5m46s
kube-system            deployment.apps/coredns                     2/2     2            2           6m52s
local-path-storage     deployment.apps/local-path-provisioner      1/1     1            1           6m50s

NAMESPACE              NAME                                                   DESIRED   CURRENT   READY   AGE
envoy-gateway-system   replicaset.apps/envoy-default-eg-e41e7b31-594f564cb9   1         1         1       4m27s
envoy-gateway-system   replicaset.apps/envoy-gateway-5b47459c4d               1         1         1       5m46s
kube-system            replicaset.apps/coredns-6f6b679f8f                     2         2         2       6m47s
local-path-storage     replicaset.apps/local-path-provisioner-57c5987fd4      1         1         1       6m47s
[Fri Jan 31 05:15:34] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
[Fri Jan 31 05:15:34] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
ls
Gateway.yaml  backend-http-service.yaml
[Fri Jan 31 05:15:46] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
../capture-envoy-data.sh --dir before_httproute
Data successfully saved in directory: before_httproute
[Fri Jan 31 05:15:57] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
ll before_httproute/
total 0
-rw-rw-r-- 1 vagrant vagrant 0 Jan 31 05:15 config_dump.log
-rw-rw-r-- 1 vagrant vagrant 0 Jan 31 05:15 clusters.log
-rw-rw-r-- 1 vagrant vagrant 0 Jan 31 05:15 clusters.json
-rw-rw-r-- 1 vagrant vagrant 0 Jan 31 05:15 listeners.json
-rw-rw-r-- 1 vagrant vagrant 0 Jan 31 05:15 listeners.log
-rw-rw-r-- 1 vagrant vagrant 0 Jan 31 05:15 server_info.log
-rw-rw-r-- 1 vagrant vagrant 0 Jan 31 05:15 stats.log
-rw-rw-r-- 1 vagrant vagrant 0 Jan 31 05:15 stats-prometheus.log
[Fri Jan 31 05:16:02] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
rm -rf ./before_httproute/*
[Fri Jan 31 05:16:08] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
[Fri Jan 31 05:16:19] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
export ENVOY_POD_NAME=$(kubectl get pod -n envoy-gateway-system --selector=gateway.envoyproxy.io/owning-gateway-namespace=default,gateway.envoyproxy.io/owning-gateway-name=eg -o jsonpath='{.items[0].metadata.name}')
kubectl port-forward pod/$ENVOY_POD_NAME -n envoy-gateway-system 19000:19000 &
[1] 38109
[Fri Jan 31 05:16:20] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
Forwarding from 127.0.0.1:19000 -> 19000
Forwarding from [::1]:19000 -> 19000
[Fri Jan 31 05:16:21] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
./capture-envoy-data.sh --dir before_httproute
-bash: ./capture-envoy-data.sh: No such file or directory
[Fri Jan 31 05:16:29] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
../capture-envoy-data.sh --dir before_httproute
Error: Directory 'before_httproute' already exists.
[Fri Jan 31 05:16:32] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
rm -rf before_httproute/
[Fri Jan 31 05:16:43] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
../capture-envoy-data.sh --dir before_httproute
[Fri Jan 31 05:16:43] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
../capture-envoy-data.sh --dir before_httproute
Handling connection for 19000
Handling connection for 19000
Handling connection for 19000
Handling connection for 19000
Handling connection for 19000
Handling connection for 19000
Handling connection for 19000
Handling connection for 19000
Data successfully saved in directory: before_httproute
[Fri Jan 31 05:16:45] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
ll before_httproute/
total 388K
-rw-rw-r-- 1 vagrant vagrant 100K Jan 31 05:16 config_dump.log
-rw-rw-r-- 1 vagrant vagrant 4.1K Jan 31 05:16 clusters.log
-rw-rw-r-- 1 vagrant vagrant 3.5K Jan 31 05:16 clusters.json
-rw-rw-r-- 1 vagrant vagrant  350 Jan 31 05:16 listeners.json
-rw-rw-r-- 1 vagrant vagrant   86 Jan 31 05:16 listeners.log
-rw-rw-r-- 1 vagrant vagrant  96K Jan 31 05:16 server_info.log
-rw-rw-r-- 1 vagrant vagrant  41K Jan 31 05:16 stats.log
-rw-rw-r-- 1 vagrant vagrant 128K Jan 31 05:16 stats-prometheus.log
[Fri Jan 31 05:16:47] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
# AT: Create backend-http service and HTTPRoute
[Fri Jan 31 05:17:03] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
k apply
edit-last-applied  (Edit latest last-applied-configuration annotations of a resource/object)
set-last-applied   (Set the last-applied-configuration annotation on a live object to match the contents of a file)
view-last-applied  (View the latest last-applied-configuration annotations of a resource/object)
[Fri Jan 31 05:17:03] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
k apply -f backend-http-service.yaml
serviceaccount/backend-http created
service/backend-http created
deployment.apps/backend-http created
httproute.gateway.networking.k8s.io/backend-http created
[Fri Jan 31 05:17:20] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
./capture-envoy-data.sh --dir after_httproute
-bash: ./capture-envoy-data.sh: No such file or directory
[Fri Jan 31 05:17:40] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
../capture-envoy-data.sh --dir after_httproute
Handling connection for 19000
Handling connection for 19000
Handling connection for 19000
Handling connection for 19000
Handling connection for 19000
Handling connection for 19000
Handling connection for 19000
Handling connection for 19000
Data successfully saved in directory: after_httproute
[Fri Jan 31 05:17:44] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
[Fri Jan 31 05:17:44] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
export ENVOY_SERVICE=$(kubectl get svc -n envoy-gateway-system --selector=gateway.envoyproxy.io/owning-gateway-namespace=default,gateway.envoyproxy.io/owning-gateway-name=eg -o jsonpath='{.items[0].metadata.name}')

kubectl -n envoy-gateway-system port-forward service/${ENVOY_SERVICE} 8888:80 &
[2] 38849
[Fri Jan 31 05:17:58] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
Forwarding from 127.0.0.1:8888 -> 10080
Forwarding from [::1]:8888 -> 10080
[Fri Jan 31 05:17:58] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
jobs
[1]-  Running                 kubectl port-forward pod/$ENVOY_POD_NAME -n envoy-gateway-system 19000:19000 &
[2]+  Running                 kubectl -n envoy-gateway-system port-forward service/${ENVOY_SERVICE} 8888:80 &
[Fri Jan 31 05:18:00] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
[Fri Jan 31 05:18:00] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
curl --verbose --header "Host: www.example.com" http://localhost:8888/get
*   Trying 127.0.0.1:8888...
* Connected to localhost (127.0.0.1) port 8888 (#0)
> GET /get HTTP/1.1
> Host: www.example.com
> User-Agent: curl/7.81.0
>Handling connection for 8888
 Accept: */*
>
* Mark bundle as not supporting multiuse
< HTTP/1.1 200 OK
< content-type: application/json
< x-content-type-options: nosniff
< date: Fri, 31 Jan 2025 05:18:06 GMT
< content-length: 460
<
{
 "path": "/get",
 "host": "www.example.com",
 "method": "GET",
 "proto": "HTTP/1.1",
 "headers": {
  "Accept": [
   "*/*"
  ],
  "User-Agent": [
   "curl/7.81.0"
  ],
  "X-Envoy-Internal": [
   "true"
  ],
  "X-Forwarded-For": [
   "10.244.1.2"
  ],
  "X-Forwarded-Proto": [
   "http"
  ],
  "X-Request-Id": [
   "a43f0623-8e5a-4ef9-9b86-0cccb7519d6c"
  ]
 },
 "namespace": "default",
 "ingress": "",
 "service": "",
 "pod": "backend-http-7c877f78d9-22q5f"
* Connection #0 to host localhost left intact
}[Fri Jan 31 05:18:06] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
[Fri Jan 31 05:18:07] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
[Fri Jan 31 05:18:07] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
[Fri Jan 31 05:18:07] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/HTTPRoute]#
cd ..
[Fri Jan 31 05:18:30] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway]#
[Fri Jan 31 05:18:30] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway]#
ls
HTTPRoute  capture-envoy-data.sh  disable-prometheus.yaml  kind-config.yaml  quickstart.yaml  tls-passthrough
[Fri Jan 31 05:18:31] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway]#
ll tls-passthrough/
total 24K
-rw------- 1 vagrant vagrant 1.7K Jan 31 04:28 example.com.key
-rw-rw-r-- 1 vagrant vagrant 1.2K Jan 31 04:28 example.com.crt
-rw------- 1 vagrant vagrant 1.7K Jan 31 04:28 passthrough.example.com.key
-rw-rw-r-- 1 vagrant vagrant  948 Jan 31 04:28 passthrough.example.com.csr
-rw-rw-r-- 1 vagrant vagrant 1.1K Jan 31 04:28 passthrough.example.com.crt
-rw-rw-r-- 1 vagrant vagrant 1.7K Jan 31 04:38 tls-passthrough.yaml
[Fri Jan 31 05:18:36] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway]#
mv tls-passthrough/ TLS-Passthrough/
[Fri Jan 31 05:18:46] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway]#
cd TLS-Passthrough/
[Fri Jan 31 05:18:47] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
[Fri Jan 31 05:18:47] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
ls
example.com.crt  example.com.key  passthrough.example.com.crt  passthrough.example.com.csr  passthrough.example.com.key  tls-passthrough.yaml
[Fri Jan 31 05:19:23] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
ll
total 24K
-rw------- 1 vagrant vagrant 1.7K Jan 31 04:28 example.com.key
-rw-rw-r-- 1 vagrant vagrant 1.2K Jan 31 04:28 example.com.crt
-rw------- 1 vagrant vagrant 1.7K Jan 31 04:28 passthrough.example.com.key
-rw-rw-r-- 1 vagrant vagrant  948 Jan 31 04:28 passthrough.example.com.csr
-rw-rw-r-- 1 vagrant vagrant 1.1K Jan 31 04:28 passthrough.example.com.crt
-rw-rw-r-- 1 vagrant vagrant 1.7K Jan 31 04:38 tls-passthrough.yaml
[Fri Jan 31 05:19:24] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
k get secrets
No resources found in default namespace.
[Fri Jan 31 05:19:43] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
kubectl create secret tls passthrough-server-certs --key=passthrough.example.com.key --cert=passthrough.example.com.crt
secret/passthrough-server-certs created
[Fri Jan 31 05:19:45] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
k get secret/passthrough-server-certs -o yaml | yq
apiVersion: v1
data:
  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUMzekNDQWNjQ0FRQXdEUVlKS29aSWh2Y05BUUVMQlFBd0xURVZNQk1HQTFVRUNnd01aWGhoYlhCc1pTQkoKYm1NdU1SUXdFZ1lEVlFRRERBdGxlR0Z0Y0d4bExtTnZiVEFlRncweU5UQXhNekV3TkRJNE5URmFGdzB5TmpBeApNekV3Tk
RJNE5URmFNRDR4SURBZUJnTlZCQU1NRjNCaGMzTjBhSEp2ZFdkb0xtVjRZVzF3YkdVdVkyOXRNUm93CkdBWURWUVFLREJGemIyMWxJRzl5WjJGdWFYcGhkR2x2YmpDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVAKQURDQ0FRb0NnZ0VCQU9EOW52ZS91ZWluQThUcWpDRDFYUkFOZ3FPWWhudXhDN29
MazB3VmZscDBkSzRuM3hBegordDQ2VHd2dWtZY1NVTzhheUZEK3ZGSFVHd1RGT2pFMFVUdDE2RUVQSC9mRDVLdHVmbGpmeHBNZU93UklNZHA4Cm1vd1pIL2QrdlZVSHRzNkFVbUdNR2J2UTNLMmNHeCs4TlpxaDJqQzl0REZEaWNxSVRFdUk1QWdFQmtibGpLTXkKNDhIU1JvUUlETEFzcDVrQWNnTnFuMnYz
b2UyU0lUa2J1YmMrWC9MUjJzSEVPTTlEU3puTE9EWkgrNlBYYWlrOQpGV0ZWTVl4QTZCcEVIUm8vZ0t0THdCeENkUlFqVzJVM2Y0c1Z0YkMzZTU1cWs1RnpxcjBTWHBNVVEzSkEyazY1CmNsSGVOTFBGWnk2aWJzTGliUERESmlyK001TzJES3V1OUdrQ0F3RUFBVEFOQmdrcWhraUc5dzBCQVFzRkFBT0MKQ
VFFQVdlVEdSWnE0UEcyN09sMFlRSWcyZFJ6dnN6LzFDZ2greUZXajY2cWFaeUZhVG5CTUtvSGpJY2lMREtDbgptU0xaZ1lEbDg0OUduWVFxNnNpbUZ5Rys3V1VDU3dQSk5PcEVSdW81aHJtdm5mVUJGNW5QaXJraXlucmJBSUlBCldsTDh3dFFiS0tFZm5OWTMrc0J5S2xDbmovSmF0b0xHUlhyQlNSUC9DL2
9tNHk3UTFsc2pBVFpYeE9FdkFhRkQKQW9qRFpvSE1CeGl1L2Y5ODNpUkxldTJqQTkybmJiZDR5V29JM0NYSHZDRjRHMm56cVdpbVhkT2ZRVU9OZXBLQgptWmJxbytFV0RIOFFOSDNVUm9JSDFkQkc2UHNtTncwU1ZMV3piTCtqaVB1cnIzOWNoc0R5aTZ6V1dUenBPdWZTCkY3NnEzNlN6MmxZeFpzd0Q1L1F
GN3UzU1VRPT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=
  tls.key: LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUV2UUlCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQktjd2dnU2pBZ0VBQW9JQkFRRGcvWjczdjdub3B3UEUKNm93ZzlWMFFEWUtqbUlaN3NRdTZDNU5NRlg1YWRIU3VKOThRTS9yZU9rOEw3cEdIRWxEdkdzaFEvcnhSMUJzRQp4VG94Tk
ZFN2RlaEJEeC8zdytTcmJuNVkzOGFUSGpzRVNESGFmSnFNR1IvM2ZyMVZCN2JPZ0ZKaGpCbTcwTnl0Cm5Cc2Z2RFdhb2Rvd3ZiUXhRNG5LaUV4TGlPUUlCQVpHNVl5ak11UEIwa2FFQ0F5d0xLZVpBSElEYXA5cjk2SHQKa2lFNUc3bTNQbC95MGRyQnhEalBRMHM1eXpnMlIvdWoxMm9wUFJWaFZUR01RT2d
hUkIwYVA0Q3JTOEFjUW5VVQpJMXRsTjMrTEZiV3d0M3VlYXBPUmM2cTlFbDZURkVOeVFOcE91WEpSM2pTenhXY3VvbTdDNG16d3d5WXEvak9UCnRneXJydlJwQWdNQkFBRUNnZjhKTVAzdGk4ZVhMdVl0MnBISm5EeDd0aEdWaUFXaEhVL1NxZVpsUC91SmRuaDQKZWozWDlrZXBZYzNEandZaTg5SHY4ckxS
bkVFcWxwK3VuT0FPWW9vWnJtekQ1aytkV2tOZFBZWldoYzNNU2lVMApaNVAzSTdWWFE5b3FkNDJ2TmtGMjdqSEV0UlNDdDdyMjNMUnBvaWE1SDg0L2I0Q05BcXFwRU5NTkdEL2pQb2lRCmtFQ2JHSGhWQWU3ckNxSm04S3dMLzY2bEk2cDQ0cHdFWmwyUDlsRzdRdWo5aktXWmlkN2hOMXdVOTZqTnFqR0sKd
U5pYW90anBJaFlwTHJMZHRaSTJuK2I0U2QwdVZDUkJaZ1JCY3FlYTduNkRqTlpkVk9IR2dzL2c1dlhXRVUzRApKTkUzMURXUU9XNDhROG42YURQTXlMNmIxQUlldWxVK0Q4dk1vL0VDZ1lFQTZvMzdYVUorQ2g2UDhyV0lIb1dtCnF0VlMvZWZoWk5reVFkQU55UlZqblUzRXppSm9JQisvdURNNEhmdHpGRj
ZBOXdJWDFpU0V6MTZLOGphaDYvRXUKaXgrODJ1NEtUNjJ2NXZSUjlJNjRWTDJqV3Y1UkZ5SERvdlBLelVYekJGZExWSnFKYU8yTmoyYkptTWcvMDBmUApZaTZqQjI4WXZ4bytaUkNLYnVrT0NCa0NnWUVBOVkvSTdRU09Sb0FjTndjMk93VUFtaWFDRys3eTArUWlPcnBiClhCL0hQM0s0WmVuaHgwem5wazV
4YlZiNWdDV0R4M24vZytCd0I2dU9JNzB3TVFlajIwUkFsU1czdktjTk5WOFgKUEU2eVVVZkRqZ0hqWjVnaWI0YklZYk1uWUtNaVVkd1BQN2xpczVQNU4rN2wzNHhhWENxQm56UnBVdXBVMkdzNgovZms0R05FQ2dZRUF6c09TamtlTExBaDlCSXVhRHEzcW1qV3JEMEJWcEwwQ1hKbTNUVWVacEpWbHBBRVlv
UmpiCnZOa0o0d1JDRWZhczRSSHJTVTZ2OU0xMjFzWHFQejlBdEV1cUE2UkxXcW5Wb2xaRjJMdm5LbXh4a0VrWDJyaGMKNlV6WHZkU253Vy9pYkJZK2cwekZ1Vi8yM3NQSDM4d3h1Rzg4TDlWemp5TG5WZGdhOEdKcGlDRUNnWUVBeEtWSwpZQlFmNDNGQUp3a05jcUlFNDIwbkVEdUFGaE5CSGdxU2t1bVg0O
FY0eVpSTURCQVlDZVFUalYzekc1M3ZNOVVNCnU0MEY2ZjZHS3pTYjNRZWpQam9nQmRCWW5TaWh1VFhYSTZKWnhpRlVCdXFZTXlOdm9DUXRYNS9hVHRjVTZyengKTVRUQ1I5Q2Q2UjdVMHZwUWVqSkg3emhIaC9ERDFUTzU0Qnl0d2FFQ2dZRUE0MzJ4Y0xsWWRyQVFBMk5wQlpJNQpLajRuQUVsRGorditZUi
9hME56ODJGWmI0UVR1SFZJS1FWWGh5OUFhemJGMUdtdzBiQTFtcVpiK0hOUHkrNktPCks1Z2ZRSURoZFJGR0tnUjRlVUNtdlV2V09oeWZmMFBPZEc5SGUweUt5aExjQ1BMRTFabXNzRXFnVXAxT1JvREwKQVphS1V4VVQ5bVJHNzIxNDFWVFNReGs9Ci0tLS0tRU5EIFBSSVZBVEUgS0VZLS0tLS0K
kind: Secret
metadata:
  creationTimestamp: "2025-01-31T05:19:45Z"
  name: passthrough-server-certs
  namespace: default
  resourceVersion: "2053"
  uid: f743ecb0-a1c6-42bd-87bb-2a4f19ea79b4
type: kubernetes.io/tls
[Fri Jan 31 05:19:55] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
vim tls-passthrough.yaml
[Fri Jan 31 05:20:31] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
[Fri Jan 31 05:20:31] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
[Fri Jan 31 05:20:33] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
# AT: Deploy TLS Passthrough application Deployment, Service and TLSRoute:
[Fri Jan 31 05:21:00] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
k apply -f tls-passthrough.yaml
service/passthrough-echoserver created
deployment.apps/passthrough-echoserver created
tlsroute.gateway.networking.k8s.io/tlsroute created
[Fri Jan 31 05:21:12] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
kubectl patch gateway eg --type=json --patch '
  - op: add
    path: /spec/listeners/-
    value:
      name: tls
      protocol: TLS
      hostname: passthrough.example.com
      port: 6443
      tls:
        mode: Passthrough
   '
gateway.gateway.networking.k8s.io/eg patched
[Fri Jan 31 05:22:03] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
kga -A
kubectl get all
NAMESPACE              NAME                                               READY   STATUS    RESTARTS   AGE
default                pod/backend-http-7c877f78d9-22q5f                  1/1     Running   0          4m46s
default                pod/passthrough-echoserver-5dddbf6b95-gzcvx        1/1     Running   0          54s
envoy-gateway-system   pod/envoy-default-eg-e41e7b31-594f564cb9-nn75s     2/2     Running   0          10m
envoy-gateway-system   pod/envoy-default-eg-e41e7b31-7489b96579-x4484     0/2     Running   0          3s
envoy-gateway-system   pod/envoy-gateway-5b47459c4d-g9v8w                 1/1     Running   0          12m
kube-system            pod/coredns-6f6b679f8f-sx85m                       1/1     Running   0          13m
kube-system            pod/coredns-6f6b679f8f-xkcsr                       1/1     Running   0          13m
kube-system            pod/etcd-env-gw-control-plane                      1/1     Running   0          13m
kube-system            pod/kindnet-97z4h                                  1/1     Running   0          13m
kube-system            pod/kindnet-qwlgm                                  1/1     Running   0          13m
kube-system            pod/kindnet-xl49m                                  1/1     Running   0          13m
kube-system            pod/kube-apiserver-env-gw-control-plane            1/1     Running   0          13m
kube-system            pod/kube-controller-manager-env-gw-control-plane   1/1     Running   0          13m
kube-system            pod/kube-proxy-dgk2w                               1/1     Running   0          13m
kube-system            pod/kube-proxy-gt7tj                               1/1     Running   0          13m
kube-system            pod/kube-proxy-ttt7h                               1/1     Running   0          13m
kube-system            pod/kube-scheduler-env-gw-control-plane            1/1     Running   0          13m
local-path-storage     pod/local-path-provisioner-57c5987fd4-9ncdn        1/1     Running   0          13m

NAMESPACE              NAME                                TYPE           CLUSTER-IP      EXTERNAL-IP   PORT(S)                                   AGE
default                service/backend-http                ClusterIP      10.96.89.57     <none>        3000/TCP                                  4m46s
default                service/kubernetes                  ClusterIP      10.96.0.1       <none>        443/TCP                                   13m
default                service/passthrough-echoserver      ClusterIP      10.96.114.47    <none>        443/TCP                                   54s
envoy-gateway-system   service/envoy-default-eg-e41e7b31   LoadBalancer   10.96.89.65     <pending>     80:31685/TCP,6443:32460/TCP               10m
envoy-gateway-system   service/envoy-gateway               ClusterIP      10.96.197.132   <none>        18000/TCP,18001/TCP,18002/TCP,19001/TCP   12m
kube-system            service/kube-dns                    ClusterIP      10.96.0.10      <none>        53/UDP,53/TCP,9153/TCP                    13m

NAMESPACE     NAME                        DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR            AGE
kube-system   daemonset.apps/kindnet      3         3         3       3            3           kubernetes.io/os=linux   13m
kube-system   daemonset.apps/kube-proxy   3         3         3       3            3           kubernetes.io/os=linux   13m

NAMESPACE              NAME                                        READY   UP-TO-DATE   AVAILABLE   AGE
default                deployment.apps/backend-http                1/1     1            1           4m46s
default                deployment.apps/passthrough-echoserver      1/1     1            1           54s
envoy-gateway-system   deployment.apps/envoy-default-eg-e41e7b31   1/1     1            1           10m
envoy-gateway-system   deployment.apps/envoy-gateway               1/1     1            1           12m
kube-system            deployment.apps/coredns                     2/2     2            2           13m
local-path-storage     deployment.apps/local-path-provisioner      1/1     1            1           13m

NAMESPACE              NAME                                                   DESIRED   CURRENT   READY   AGE
default                replicaset.apps/backend-http-7c877f78d9                1         1         1       4m46s
default                replicaset.apps/passthrough-echoserver-5dddbf6b95      1         1         1       54s
envoy-gateway-system   replicaset.apps/envoy-default-eg-e41e7b31-594f564cb9   1         1         1       10m
envoy-gateway-system   replicaset.apps/envoy-default-eg-e41e7b31-7489b96579   1         1         0       3s
envoy-gateway-system   replicaset.apps/envoy-gateway-5b47459c4d               1         1         1       12m
kube-system            replicaset.apps/coredns-6f6b679f8f                     2         2         2       13m
local-path-storage     replicaset.apps/local-path-provisioner-57c5987fd4      1         1         1       13m
[Fri Jan 31 05:22:06] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
[Fri Jan 31 05:22:06] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
kga
kubectl get all
NAME                                          READY   STATUS    RESTARTS   AGE
pod/backend-http-7c877f78d9-22q5f             1/1     Running   0          4m51s
pod/passthrough-echoserver-5dddbf6b95-gzcvx   1/1     Running   0          59s

NAME                             TYPE        CLUSTER-IP     EXTERNAL-IP   PORT(S)    AGE
service/backend-http             ClusterIP   10.96.89.57    <none>        3000/TCP   4m51s
service/kubernetes               ClusterIP   10.96.0.1      <none>        443/TCP    13m
service/passthrough-echoserver   ClusterIP   10.96.114.47   <none>        443/TCP    59s

NAME                                     READY   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/backend-http             1/1     1            1           4m51s
deployment.apps/passthrough-echoserver   1/1     1            1           59s

NAME                                                DESIRED   CURRENT   READY   AGE
replicaset.apps/backend-http-7c877f78d9             1         1         1       4m51s
replicaset.apps/passthrough-echoserver-5dddbf6b95   1         1         1       59s
[Fri Jan 31 05:22:11] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
k get gateway/eg -o yaml | yq
apiVersion: gateway.networking.k8s.io/v1
kind: Gateway
metadata:
  annotations:
    kubectl.kubernetes.io/last-applied-configuration: |
      {"apiVersion":"gateway.networking.k8s.io/v1","kind":"Gateway","metadata":{"annotations":{},"name":"eg","namespace":"default"},"spec":{"gatewayClassName":"eg","listeners":[{"name":"http","port":80,"protocol":"HTTP"}]}}
  creationTimestamp: "2025-01-31T05:11:07Z"
  generation: 2
  name: eg
  namespace: default
  resourceVersion: "2419"
  uid: a6e5a3e1-a21a-49e9-9edb-968653ec08ad
spec:
  gatewayClassName: eg
  listeners:
    - allowedRoutes:
        namespaces:
          from: Same
      name: http
      port: 80
      protocol: HTTP
    - allowedRoutes:
        namespaces:
          from: Same
      hostname: passthrough.example.com
      name: tls
      port: 6443
      protocol: TLS
      tls:
        mode: Passthrough
status:
  conditions:
    - lastTransitionTime: "2025-01-31T05:22:14Z"
      message: The Gateway has been scheduled by Envoy Gateway
      observedGeneration: 2
      reason: Accepted
      status: "True"
      type: Accepted
    - lastTransitionTime: "2025-01-31T05:22:14Z"
      message: No addresses have been assigned to the Gateway
      observedGeneration: 2
      reason: AddressNotAssigned
      status: "False"
      type: Programmed
  listeners:
    - attachedRoutes: 1
      conditions:
        - lastTransitionTime: "2025-01-31T05:22:03Z"
          message: Sending translated listener configuration to the data plane
          observedGeneration: 2
          reason: Programmed
          status: "True"
          type: Programmed
        - lastTransitionTime: "2025-01-31T05:22:03Z"
          message: Listener has been successfully translated
          observedGeneration: 2
          reason: Accepted
          status: "True"
          type: Accepted
        - lastTransitionTime: "2025-01-31T05:22:03Z"
          message: Listener references have been resolved
          observedGeneration: 2
          reason: ResolvedRefs
          status: "True"
          type: ResolvedRefs
      name: http
      supportedKinds:
        - group: gateway.networking.k8s.io
          kind: HTTPRoute
        - group: gateway.networking.k8s.io
          kind: GRPCRoute
    - attachedRoutes: 1
      conditions:
        - lastTransitionTime: "2025-01-31T05:22:03Z"
          message: Sending translated listener configuration to the data plane
          observedGeneration: 2
          reason: Programmed
          status: "True"
          type: Programmed
        - lastTransitionTime: "2025-01-31T05:22:03Z"
          message: Listener has been successfully translated
          observedGeneration: 2
          reason: Accepted
          status: "True"
          type: Accepted
        - lastTransitionTime: "2025-01-31T05:22:03Z"
          message: Listener references have been resolved
          observedGeneration: 2
          reason: ResolvedRefs
          status: "True"
          type: ResolvedRefs
      name: tls
      supportedKinds:
        - group: gateway.networking.k8s.io
          kind: TLSRoute
[Fri Jan 31 05:22:24] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
[Fri Jan 31 05:22:57] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
[Fri Jan 31 05:22:58] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
[Fri Jan 31 05:22:58] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
[Fri Jan 31 05:22:58] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
# AT: Port forward to the Envoy service:
[Fri Jan 31 05:23:18] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
kubectl -n envoy-gateway-system port-forward service/${ENVOY_SERVICE} 6043:6443 &
[3] 40956
[Fri Jan 31 05:23:34] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
Forwarding from 127.0.0.1:6043 -> 6443
Forwarding from [::1]:6043 -> 6443
[Fri Jan 31 05:23:35] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
jobs
[1]   Running                 kubectl port-forward pod/$ENVOY_POD_NAME -n envoy-gateway-system 19000:19000 &  (wd: /shared-with-host/envoy-gateway/HTTPRoute)
[2]-  Running                 kubectl -n envoy-gateway-system port-forward service/${ENVOY_SERVICE} 8888:80 &  (wd: /shared-with-host/envoy-gateway/HTTPRoute)
[3]+  Running                 kubectl -n envoy-gateway-system port-forward service/${ENVOY_SERVICE} 6043:6443 &
[Fri Jan 31 05:23:37] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
# AT: Curl the example app through Envoy proxy:
[Fri Jan 31 05:23:53] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
[Fri Jan 31 05:24:02] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
[Fri Jan 31 05:24:02] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
curl -v --resolve "passthrough.example.com:6043:127.0.0.1" https://passthrough.example.com:6043 \
--cacert passthrough.example.com.crt
* Added passthrough.example.com:6043:127.0.0.1 to DNS cache
* Hostname passthrough.example.com was found in DNS cache
*   Trying 127.0.0.1:6043...
* Connected to passthrough.example.com (127.0.0.1) port 6043 (#0)
Handling connection for 6043
* ALPN, offering h2
* ALPN, offering http/1.1
*  CAfile: passthrough.example.com.crt
*  CApath: /etc/ssl/certs
* TLSv1.0 (OUT), TLS header, Certificate Status (22):
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
* TLSv1.2 (IN), TLS header, Certificate Status (22):
* TLSv1.3 (IN), TLS handshake, Server hello (2):
* TLSv1.2 (IN), TLS header, Finished (20):
* TLSv1.2 (IN), TLS header, Supplemental data (23):
* TLSv1.3 (IN), TLS handshake, Encrypted Extensions (8):
* TLSv1.2 (IN), TLS header, Supplemental data (23):
* TLSv1.3 (IN), TLS handshake, Certificate (11):
* TLSv1.2 (IN), TLS header, Supplemental data (23):
* TLSv1.3 (IN), TLS handshake, CERT verify (15):
* TLSv1.2 (IN), TLS header, Supplemental data (23):
* TLSv1.3 (IN), TLS handshake, Finished (20):
* TLSv1.2 (OUT), TLS header, Finished (20):
* TLSv1.3 (OUT), TLS change cipher, Change cipher spec (1):
* TLSv1.2 (OUT), TLS header, Supplemental data (23):
* TLSv1.3 (OUT), TLS handshake, Finished (20):
* SSL connection using TLSv1.3 / TLS_AES_128_GCM_SHA256
* ALPN, server accepted to use h2
* Server certificate:
*  subject: CN=passthrough.example.com; O=some organization
*  start date: Jan 31 04:28:51 2025 GMT
*  expire date: Jan 31 04:28:51 2026 GMT
*  common name: passthrough.example.com (matched)
*  issuer: O=example Inc.; CN=example.com
*  SSL certificate verify ok.
* Using HTTP2, server supports multiplexing
* Connection state changed (HTTP/2 confirmed)
* Copying HTTP/2 data in stream buffer to connection buffer after upgrade: len=0
* TLSv1.2 (OUT), TLS header, Supplemental data (23):
* TLSv1.2 (OUT), TLS header, Supplemental data (23):
* TLSv1.2 (OUT), TLS header, Supplemental data (23):
* Using Stream ID: 1 (easy handle 0x562645f93eb0)
* TLSv1.2 (OUT), TLS header, Supplemental data (23):
> GET / HTTP/2
> Host: passthrough.example.com:6043
> user-agent: curl/7.81.0
> accept: */*
>
* TLSv1.2 (IN), TLS header, Supplemental data (23):
* TLSv1.3 (IN), TLS handshake, Newsession Ticket (4):
* TLSv1.2 (IN), TLS header, Supplemental data (23):
* Connection state changed (MAX_CONCURRENT_STREAMS == 250)!
* TLSv1.2 (OUT), TLS header, Supplemental data (23):
* TLSv1.2 (IN), TLS header, Supplemental data (23):
* TLSv1.2 (IN), TLS header, Supplemental data (23):
* TLSv1.2 (IN), TLS header, Supplemental data (23):
< HTTP/2 200
< content-type: application/json
< x-content-type-options: nosniff
< content-length: 443
< date: Fri, 31 Jan 2025 05:24:04 GMT
<
* TLSv1.2 (IN), TLS header, Supplemental data (23):
{
 "path": "/",
 "host": "passthrough.example.com:6043",
 "method": "GET",
 "proto": "HTTP/2.0",
 "headers": {
  "Accept": [
   "*/*"
  ],
  "User-Agent": [
   "curl/7.81.0"
  ]
 },
 "namespace": "default",
 "ingress": "",
 "service": "",
 "pod": "passthrough-echoserver-5dddbf6b95-gzcvx",
 "tls": {
  "version": "TLSv1.3",
  "serverName": "passthrough.example.com",
  "negotiatedProtocol": "h2",
  "cipherSuite": "TLS_AES_128_GCM_SHA256"
 }
* Connection #0 to host passthrough.example.com left intact
}[Fri Jan 31 05:24:04] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
[Fri Jan 31 05:24:05] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
[Fri Jan 31 05:24:05] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
[Fri Jan 31 05:24:05] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
[Fri Jan 31 05:24:41] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
[Fri Jan 31 05:24:41] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
[Fri Jan 31 05:24:41] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
#curl -v --resolve "passthrough.example.com:6043:127.0.0.1" https://passthrough.example.com:6043 --cacert passthrough.example.com.crt
[Fri Jan 31 05:25:53] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
jobs
[1]   Running                 kubectl port-forward pod/$ENVOY_POD_NAME -n envoy-gateway-system 19000:19000 &  (wd: /shared-with-host/envoy-gateway/HTTPRoute)
[2]-  Running                 kubectl -n envoy-gateway-system port-forward service/${ENVOY_SERVICE} 8888:80 &  (wd: /shared-with-host/envoy-gateway/HTTPRoute)
[3]+  Running                 kubectl -n envoy-gateway-system port-forward service/${ENVOY_SERVICE} 6043:6443 &
[Fri Jan 31 05:25:54] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
curl -v https://127.0.0.1:6043 --cacert passthrough.example.com.crt
*   Trying 127.0.0.1:6043...
Handling connection for 6043
* Connected to 127.0.0.1 (127.0.0.1) port 6043 (#0)
* ALPN, offering h2
* ALPN, offering http/1.1
*  CAfile: passthrough.example.com.crt
*  CApath: /etc/ssl/certs
* TLSv1.0 (OUT), TLS header, Certificate Status (22):
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
* TLSv1.0 (OUT), TLS header, Unknown (21):
* TLSv1.3 (OUT), TLS alert, decode error (562):
* error:0A000126:SSL routines::unexpected eof while reading
* Closing connection 0
curl: (35) error:0A000126:SSL routines::unexpected eof while reading
[Fri Jan 31 05:26:29] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
curl -v http://127.0.0.1:6043 --cacert passthrough.example.com.crt
*   Trying 127.0.0.1:6043...
* Handling connection for 6043
Connected to 127.0.0.1 (127.0.0.1) port 6043 (#0)
> GET / HTTP/1.1
> Host: 127.0.0.1:6043
> User-Agent: curl/7.81.0
> Accept: */*
>
* Empty reply from server
* Closing connection 0
curl: (52) Empty reply from server
[Fri Jan 31 05:26:46] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
ls
example.com.crt  example.com.key  passthrough.example.com.crt  passthrough.example.com.csr  passthrough.example.com.key  tls-passthrough.yaml
[Fri Jan 31 05:31:05] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
[Fri Jan 31 05:31:08] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
../capture-envoy-data.sh --dir ./after_tlspassthrough
Handling connection for 19000
E0131 05:31:51.684640   38109 portforward.go:413] "Unhandled Error" err="an error occurred forwarding 19000 -> 19000: error forwarding port 19000 to pod 484f286c4fc337b6a4e0ae13667aaab5f7bd2d1826eacbfc4de127e7d937c01e, uid : fail
ed to find sandbox \"484f286c4fc337b6a4e0ae13667aaab5f7bd2d1826eacbfc4de127e7d937c01e\" in store: not found"
error: lost connection to pod
Data successfully saved in directory: ./after_tlspassthrough
[1]   Exit 1                  kubectl port-forward pod/$ENVOY_POD_NAME -n envoy-gateway-system 19000:19000  (wd: /shared-with-host/envoy-gateway/HTTPRoute)
(wd now: /shared-with-host/envoy-gateway/TLS-Passthrough)
[Fri Jan 31 05:31:51] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
jobs
[2]-  Running                 kubectl -n envoy-gateway-system port-forward service/${ENVOY_SERVICE} 8888:80 &  (wd: /shared-with-host/envoy-gateway/HTTPRoute)
[3]+  Running                 kubectl -n envoy-gateway-system port-forward service/${ENVOY_SERVICE} 6043:6443 &
[Fri Jan 31 05:32:00] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
echo $$ENVOY_POD_NAME
31460ENVOY_POD_NAME
[Fri Jan 31 05:32:35] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
ll ../HTTPRoute/
[Fri Jan 31 05:32:35] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
ll ../HTTPRoute/
total 16K
-rw-rw-r-- 1 vagrant vagrant 1.5K Jan 31 04:59 backend-http-service.yaml
-rw-rw-r-- 1 vagrant vagrant  326 Jan 31 04:59 Gateway.yaml
drwxrwxr-x 1 vagrant vagrant 4.0K Jan 31 05:16 before_httproute
drwxrwxr-x 1 vagrant vagrant 4.0K Jan 31 05:17 after_httproute
[Fri Jan 31 05:32:52] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
ll ../HTTPRoute/after_httproute/
total 428K
-rw-rw-r-- 1 vagrant vagrant 102K Jan 31 05:17 config_dump.log
-rw-rw-r-- 1 vagrant vagrant 6.6K Jan 31 05:17 clusters.log
-rw-rw-r-- 1 vagrant vagrant 4.8K Jan 31 05:17 clusters.json
-rw-rw-r-- 1 vagrant vagrant  350 Jan 31 05:17 listeners.json
-rw-rw-r-- 1 vagrant vagrant   86 Jan 31 05:17 listeners.log
-rw-rw-r-- 1 vagrant vagrant  96K Jan 31 05:17 server_info.log
-rw-rw-r-- 1 vagrant vagrant  51K Jan 31 05:17 stats.log
-rw-rw-r-- 1 vagrant vagrant 150K Jan 31 05:17 stats-prometheus.log
[Fri Jan 31 05:32:54] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
export ENVOY_POD_NAME=$(kubectl get pod -n envoy-gateway-system --selector=gateway.envoyproxy.io/owning-gateway-namespace=default,gateway.envoyproxy.io/owning-gateway-name=eg -o jsonpath='{.items[0].metadata.name}')
[Fri Jan 31 05:34:12] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
echo $$ENVOY_POD_NAME
31460ENVOY_POD_NAME
[Fri Jan 31 05:34:15] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
k get pod,service -A -n envoy-gateway-system
NAMESPACE              NAME                                               READY   STATUS    RESTARTS   AGE
default                pod/backend-http-7c877f78d9-22q5f                  1/1     Running   0          17m
default                pod/passthrough-echoserver-5dddbf6b95-gzcvx        1/1     Running   0          13m
envoy-gateway-system   pod/envoy-default-eg-e41e7b31-7489b96579-x4484     2/2     Running   0          12m
envoy-gateway-system   pod/envoy-gateway-5b47459c4d-g9v8w                 1/1     Running   0          24m
kube-system            pod/coredns-6f6b679f8f-sx85m                       1/1     Running   0          25m
kube-system            pod/coredns-6f6b679f8f-xkcsr                       1/1     Running   0          25m
kube-system            pod/etcd-env-gw-control-plane                      1/1     Running   0          25m
kube-system            pod/kindnet-97z4h                                  1/1     Running   0          25m
kube-system            pod/kindnet-qwlgm                                  1/1     Running   0          25m
kube-system            pod/kindnet-xl49m                                  1/1     Running   0          25m
kube-system            pod/kube-apiserver-env-gw-control-plane            1/1     Running   0          25m
kube-system            pod/kube-controller-manager-env-gw-control-plane   1/1     Running   0          25m
kube-system            pod/kube-proxy-dgk2w                               1/1     Running   0          25m
kube-system            pod/kube-proxy-gt7tj                               1/1     Running   0          25m
kube-system            pod/kube-proxy-ttt7h                               1/1     Running   0          25m
kube-system            pod/kube-scheduler-env-gw-control-plane            1/1     Running   0          25m
local-path-storage     pod/local-path-provisioner-57c5987fd4-9ncdn        1/1     Running   0          25m

NAMESPACE              NAME                                TYPE           CLUSTER-IP      EXTERNAL-IP   PORT(S)                                   AGE
default                service/backend-http                ClusterIP      10.96.89.57     <none>        3000/TCP                                  17m
default                service/kubernetes                  ClusterIP      10.96.0.1       <none>        443/TCP                                   25m
default                service/passthrough-echoserver      ClusterIP      10.96.114.47    <none>        443/TCP                                   13m
envoy-gateway-system   service/envoy-default-eg-e41e7b31   LoadBalancer   10.96.89.65     <pending>     80:31685/TCP,6443:32460/TCP               23m
envoy-gateway-system   service/envoy-gateway               ClusterIP      10.96.197.132   <none>        18000/TCP,18001/TCP,18002/TCP,19001/TCP   24m
kube-system            service/kube-dns                    ClusterIP      10.96.0.10      <none>        53/UDP,53/TCP,9153/TCP                    25m
[Fri Jan 31 05:34:38] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
kubectl get pod -n envoy-gateway-system --selector=gateway.envoyproxy.io/owning-gateway-namespace=default,gateway.envoyproxy.io/owning-gateway-name=eg -o jsonpath='{.items[0].metadata.name}'
envoy-default-eg-e41e7b31-7489b96579-x4484[Fri Jan 31 05:35:20] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
export ENVOY_POD_NAME=$(kubectl get pod -n envoy-gateway-system --selector=gateway.envoyproxy.io/owning-gateway-namespace=default,gateway.envoyproxy.io/owning-gateway-name=eg -o jsonpath='{.items[0].metadata.name}')
[Fri Jan 31 05:35:32] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
echo $$ENVOY_POD_NAME
31460ENVOY_POD_NAME
[Fri Jan 31 05:35:35] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
[Fri Jan 31 05:35:35] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
echo $ENVOY_POD_NAME
envoy-default-eg-e41e7b31-7489b96579-x4484
[Fri Jan 31 05:36:26] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
kubectl port-forward pod/$ENVOY_POD_NAME -n envoy-gateway-system 19000:19000 &
[4] 44180
[Fri Jan 31 05:36:37] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
Forwarding from 127.0.0.1:19000 -> 19000
Forwarding from [::1]:19000 -> 19000
[Fri Jan 31 05:36:38] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
jobs
[2]   Running                 kubectl -n envoy-gateway-system port-forward service/${ENVOY_SERVICE} 8888:80 &  (wd: /shared-with-host/envoy-gateway/HTTPRoute)
[3]-  Running                 kubectl -n envoy-gateway-system port-forward service/${ENVOY_SERVICE} 6043:6443 &
[4]+  Running                 kubectl port-forward pod/$ENVOY_POD_NAME -n envoy-gateway-system 19000:19000 &
[Fri Jan 31 05:36:40] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
[Fri Jan 31 05:36:41] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
tail ../capture-envoy-data.sh
execute "curl -s localhost:19000/server_info > '$DIR_NAME/server_info.log'"
execute "curl -s localhost:19000/stats > '$DIR_NAME/stats.log'"
execute "curl -s localhost:19000/stats/prometheus > '$DIR_NAME/stats-prometheus.log'"

# Final message
if [[ "$DRY_RUN" = true ]]; then
  echo "Dry-run completed. No changes were made."
else
  echo "Data successfully saved in directory: $DIR_NAME"
fi
[Fri Jan 31 05:36:46] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
[Fri Jan 31 05:37:06] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
curl -s localhost:19000/stats | head
Handling connection for 19000
cluster.httproute/default/backend-http/rule/0.version_text: "4"
cluster.tlsroute/default/tlsroute/rule/-1.version_text: "4"
cluster_manager.cds.version_text: "4"
control_plane.identifier: ""
http.http-10080.rds.default/eg/http.version_text: "4"
listener_manager.lds.version_text: "4"
sds.xds_certificate.version_text: ""
sds.xds_trusted_ca.version_text: ""
cluster.httproute/default/backend-http/rule/0.assignment_stale: 0
cluster.httproute/default/backend-http/rule/0.assignment_timeout_received: 0
[Fri Jan 31 05:37:15] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
[Fri Jan 31 05:37:15] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
ls
after_tlspassthrough  example.com.crt  example.com.key  passthrough.example.com.crt  passthrough.example.com.csr  passthrough.example.com.key  tls-passthrough.yaml
[Fri Jan 31 05:38:14] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
ll after_tlspassthrough/
total 0
-rw-rw-r-- 1 vagrant vagrant 0 Jan 31 05:31 config_dump.log
-rw-rw-r-- 1 vagrant vagrant 0 Jan 31 05:31 clusters.log
-rw-rw-r-- 1 vagrant vagrant 0 Jan 31 05:31 clusters.json
-rw-rw-r-- 1 vagrant vagrant 0 Jan 31 05:31 listeners.json
-rw-rw-r-- 1 vagrant vagrant 0 Jan 31 05:31 listeners.log
-rw-rw-r-- 1 vagrant vagrant 0 Jan 31 05:31 server_info.log
-rw-rw-r-- 1 vagrant vagrant 0 Jan 31 05:31 stats.log
-rw-rw-r-- 1 vagrant vagrant 0 Jan 31 05:31 stats-prometheus.log
[Fri Jan 31 05:38:18] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
rm -rf after_tlspassthrough/
[Fri Jan 31 05:38:20] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
../capture-envoy-data.sh --dir after_tlspassthrough
Handling connection for 19000
Handling connection for 19000
Handling connection for 19000
Handling connection for 19000
Handling connection for 19000
Handling connection for 19000
Handling connection for 19000
Handling connection for 19000
Data successfully saved in directory: after_tlspassthrough
[Fri Jan 31 05:38:23] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
ll after_tlspassthrough/
total 476K
-rw-rw-r-- 1 vagrant vagrant 107K Jan 31 05:38 config_dump.log
-rw-rw-r-- 1 vagrant vagrant 8.9K Jan 31 05:38 clusters.log
-rw-rw-r-- 1 vagrant vagrant 6.1K Jan 31 05:38 clusters.json
-rw-rw-r-- 1 vagrant vagrant  496 Jan 31 05:38 listeners.json
-rw-rw-r-- 1 vagrant vagrant  115 Jan 31 05:38 listeners.log
-rw-rw-r-- 1 vagrant vagrant  96K Jan 31 05:38 server_info.log
-rw-rw-r-- 1 vagrant vagrant  63K Jan 31 05:38 stats.log
-rw-rw-r-- 1 vagrant vagrant 179K Jan 31 05:38 stats-prometheus.log
[Fri Jan 31 05:38:26] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
[Fri Jan 31 05:38:26] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
curl -v --resolve "passthrough.example.com:6043:127.0.0.1" https://passthrough.example.com:6043 --cacert passthrough.example.com.crt
* Added passthrough.example.com:6043:127.0.0.1 to DNS cache
* Hostname passthrough.example.com was found in DNS cache
*   Trying 127.0.0.1:6043...
Handling connection for 6043
* Connected to passthrough.example.com (127.0.0.1) port 6043 (#0)
* ALPN, offering h2
* ALPN, offering http/1.1
*  CAfile: passthrough.example.com.crt
*  CApath: /etc/ssl/certs
* TLSv1.0 (OUT), TLS header, Certificate Status (22):
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
* TLSv1.2 (IN), TLS header, Certificate Status (22):
* TLSv1.3 (IN), TLS handshake, Server hello (2):
* TLSv1.2 (IN), TLS header, Finished (20):
* TLSv1.2 (IN), TLS header, Supplemental data (23):
* TLSv1.3 (IN), TLS handshake, Encrypted Extensions (8):
* TLSv1.2 (IN), TLS header, Supplemental data (23):
* TLSv1.3 (IN), TLS handshake, Certificate (11):
* TLSv1.2 (IN), TLS header, Supplemental data (23):
* TLSv1.3 (IN), TLS handshake, CERT verify (15):
* TLSv1.2 (IN), TLS header, Supplemental data (23):
* TLSv1.3 (IN), TLS handshake, Finished (20):
* TLSv1.2 (OUT), TLS header, Finished (20):
* TLSv1.3 (OUT), TLS change cipher, Change cipher spec (1):
* TLSv1.2 (OUT), TLS header, Supplemental data (23):
* TLSv1.3 (OUT), TLS handshake, Finished (20):
* SSL connection using TLSv1.3 / TLS_AES_128_GCM_SHA256
* ALPN, server accepted to use h2
* Server certificate:
*  subject: CN=passthrough.example.com; O=some organization
*  start date: Jan 31 04:28:51 2025 GMT
*  expire date: Jan 31 04:28:51 2026 GMT
*  common name: passthrough.example.com (matched)
*  issuer: O=example Inc.; CN=example.com
*  SSL certificate verify ok.
* Using HTTP2, server supports multiplexing
* Connection state changed (HTTP/2 confirmed)
* Copying HTTP/2 data in stream buffer to connection buffer after upgrade: len=0
* TLSv1.2 (OUT), TLS header, Supplemental data (23):
* TLSv1.2 (OUT), TLS header, Supplemental data (23):
* TLSv1.2 (OUT), TLS header, Supplemental data (23):
* Using Stream ID: 1 (easy handle 0x559410aaaeb0)
* TLSv1.2 (OUT), TLS header, Supplemental data (23):
> GET / HTTP/2
> Host: passthrough.example.com:6043
> user-agent: curl/7.81.0
> accept: */*
>
* TLSv1.2 (IN), TLS header, Supplemental data (23):
* TLSv1.3 (IN), TLS handshake, Newsession Ticket (4):
* TLSv1.2 (IN), TLS header, Supplemental data (23):
* Connection state changed (MAX_CONCURRENT_STREAMS == 250)!
* TLSv1.2 (OUT), TLS header, Supplemental data (23):
* TLSv1.2 (IN), TLS header, Supplemental data (23):
* TLSv1.2 (IN), TLS header, Supplemental data (23):
* TLSv1.2 (IN), TLS header, Supplemental data (23):
< HTTP/2 200
< content-type: application/json
< x-content-type-options: nosniff
< content-length: 443
< date: Fri, 31 Jan 2025 05:43:45 GMT
<
* TLSv1.2 (IN), TLS header, Supplemental data (23):
{
 "path": "/",
 "host": "passthrough.example.com:6043",
 "method": "GET",
 "proto": "HTTP/2.0",
 "headers": {
  "Accept": [
   "*/*"
  ],
  "User-Agent": [
   "curl/7.81.0"
  ]
 },
 "namespace": "default",
 "ingress": "",
 "service": "",
 "pod": "passthrough-echoserver-5dddbf6b95-gzcvx",
 "tls": {
  "version": "TLSv1.3",
  "serverName": "passthrough.example.com",
  "negotiatedProtocol": "h2",
  "cipherSuite": "TLS_AES_128_GCM_SHA256"
 }
* Connection #0 to host passthrough.example.com left intact
}[Fri Jan 31 05:43:45] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
[Fri Jan 31 05:43:46] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
[Fri Jan 31 05:44:18] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
k get tlsroutes.gateway.networking.k8s.io
[Fri Jan 31 05:44:18] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
k get tlsroutes.gateway.networking.k8s.io -o yaml
apiVersion: v1
items:
- apiVersion: gateway.networking.k8s.io/v1alpha2
  kind: TLSRoute
  metadata:
    annotations:
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"gateway.networking.k8s.io/v1alpha2","kind":"TLSRoute","metadata":{"annotations":{},"name":"tlsroute","namespace":"default"},"spec":{"hostnames":["passthrough.example.com"],"parentRefs":[{"name":"eg"}],"rule
s":[{"backendRefs":[{"group":"","kind":"Service","name":"passthrough-echoserver","port":443,"weight":1}]}]}}
    creationTimestamp: "2025-01-31T05:21:12Z"
    generation: 1
    name: tlsroute
    namespace: default
    resourceVersion: "2360"
    uid: 316fe78b-e44e-4542-8467-9e0de046e305
  spec:
    hostnames:
    - passthrough.example.com
    parentRefs:
    - group: gateway.networking.k8s.io
      kind: Gateway
      name: eg
    rules:
    - backendRefs:
      - group: ""
        kind: Service
        name: passthrough-echoserver
        port: 443
        weight: 1
  status:
    parents:
    - conditions:
      - lastTransitionTime: "2025-01-31T05:22:03Z"
        message: Route is accepted
        observedGeneration: 1
        reason: Accepted
        status: "True"
        type: Accepted
      - lastTransitionTime: "2025-01-31T05:22:03Z"
        message: Resolved all the Object references for the Route
        observedGeneration: 1
        reason: ResolvedRefs
        status: "True"
        type: ResolvedRefs
      controllerName: gateway.envoyproxy.io/gatewayclass-controller
      parentRef:
        group: gateway.networking.k8s.io
        kind: Gateway
        name: eg
kind: List
metadata:
  resourceVersion: ""
[Fri Jan 31 05:57:23] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
[Fri Jan 31 06:14:33] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
[Fri Jan 31 06:14:33] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
k get gateway/eg -o yaml | yq
[Fri Jan 31 06:14:33] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
k get gateway/eg -o yaml | yq
apiVersion: gateway.networking.k8s.io/v1
kind: Gateway
metadata:
  annotations:
    kubectl.kubernetes.io/last-applied-configuration: |
      {"apiVersion":"gateway.networking.k8s.io/v1","kind":"Gateway","metadata":{"annotations":{},"name":"eg","namespace":"default"},"spec":{"gatewayClassName":"eg","listeners":[{"name":"http","port":80,"protocol":"HTTP"}]}}
  creationTimestamp: "2025-01-31T05:11:07Z"
  generation: 2
  name: eg
  namespace: default
  resourceVersion: "2419"
  uid: a6e5a3e1-a21a-49e9-9edb-968653ec08ad
spec:
  gatewayClassName: eg
  listeners:
    - allowedRoutes:
        namespaces:
          from: Same
      name: http
      port: 80
      protocol: HTTP
    - allowedRoutes:
        namespaces:
          from: Same
      hostname: passthrough.example.com
      name: tls
      port: 6443
      protocol: TLS
      tls:
        mode: Passthrough
status:
  conditions:
    - lastTransitionTime: "2025-01-31T05:22:14Z"
      message: The Gateway has been scheduled by Envoy Gateway
      observedGeneration: 2
      reason: Accepted
      status: "True"
      type: Accepted
    - lastTransitionTime: "2025-01-31T05:22:14Z"
      message: No addresses have been assigned to the Gateway
      observedGeneration: 2
      reason: AddressNotAssigned
      status: "False"
      type: Programmed
  listeners:
    - attachedRoutes: 1
      conditions:
        - lastTransitionTime: "2025-01-31T05:22:03Z"
          message: Sending translated listener configuration to the data plane
          observedGeneration: 2
          reason: Programmed
          status: "True"
          type: Programmed
        - lastTransitionTime: "2025-01-31T05:22:03Z"
          message: Listener has been successfully translated
          observedGeneration: 2
          reason: Accepted
          status: "True"
          type: Accepted
        - lastTransitionTime: "2025-01-31T05:22:03Z"
          message: Listener references have been resolved
          observedGeneration: 2
          reason: ResolvedRefs
          status: "True"
          type: ResolvedRefs
      name: http
      supportedKinds:
        - group: gateway.networking.k8s.io
          kind: HTTPRoute
        - group: gateway.networking.k8s.io
          kind: GRPCRoute
    - attachedRoutes: 1
      conditions:
        - lastTransitionTime: "2025-01-31T05:22:03Z"
          message: Sending translated listener configuration to the data plane
          observedGeneration: 2
          reason: Programmed
          status: "True"
          type: Programmed
        - lastTransitionTime: "2025-01-31T05:22:03Z"
          message: Listener has been successfully translated
          observedGeneration: 2
          reason: Accepted
          status: "True"
          type: Accepted
        - lastTransitionTime: "2025-01-31T05:22:03Z"
          message: Listener references have been resolved
          observedGeneration: 2
          reason: ResolvedRefs
          status: "True"
          type: ResolvedRefs
      name: tls
      supportedKinds:
        - group: gateway.networking.k8s.io
          kind: TLSRoute
[Fri Jan 31 06:14:49] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
[Fri Jan 31 06:14:49] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
ll
total 28K
-rw------- 1 vagrant vagrant 1.7K Jan 31 04:28 example.com.key
-rw-rw-r-- 1 vagrant vagrant 1.2K Jan 31 04:28 example.com.crt
-rw------- 1 vagrant vagrant 1.7K Jan 31 04:28 passthrough.example.com.key
-rw-rw-r-- 1 vagrant vagrant  948 Jan 31 04:28 passthrough.example.com.csr
-rw-rw-r-- 1 vagrant vagrant 1.1K Jan 31 04:28 passthrough.example.com.crt
-rw-rw-r-- 1 vagrant vagrant 1.7K Jan 31 04:38 tls-passthrough.yaml
drwxrwxr-x 1 vagrant vagrant 4.0K Jan 31 05:38 after_tlspassthrough
[Fri Jan 31 06:15:19] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
cd ./
[Fri Jan 31 06:15:29] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway/TLS-Passthrough]#
cd ../
[Fri Jan 31 06:15:30] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway]#
[Fri Jan 31 06:15:30] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway]#
ll HTTPRoute/
total 16K
-rw-rw-r-- 1 vagrant vagrant 1.5K Jan 31 04:59 backend-http-service.yaml
-rw-rw-r-- 1 vagrant vagrant  326 Jan 31 04:59 Gateway.yaml
drwxrwxr-x 1 vagrant vagrant 4.0K Jan 31 05:16 before_httproute
drwxrwxr-x 1 vagrant vagrant 4.0K Jan 31 05:17 after_httproute
[Fri Jan 31 06:15:35] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway]#
ls
HTTPRoute  TLS-Passthrough  capture-envoy-data.sh  disable-prometheus.yaml  kind-config.yaml  quickstart.yaml
[Fri Jan 31 06:15:58] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway]#
rm -rf disable-prometheus.yaml quickstart.yaml
[Fri Jan 31 06:16:13] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway]#
ll HTTPRoute/
total 16K
-rw-rw-r-- 1 vagrant vagrant 1.5K Jan 31 04:59 backend-http-service.yaml
-rw-rw-r-- 1 vagrant vagrant  326 Jan 31 04:59 Gateway.yaml
drwxrwxr-x 1 vagrant vagrant 4.0K Jan 31 05:16 before_httproute
drwxrwxr-x 1 vagrant vagrant 4.0K Jan 31 05:17 after_httproute
[Fri Jan 31 06:16:16] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway]#
ll TLS-Passthrough/
total 28K
-rw------- 1 vagrant vagrant 1.7K Jan 31 04:28 example.com.key
-rw-rw-r-- 1 vagrant vagrant 1.2K Jan 31 04:28 example.com.crt
-rw------- 1 vagrant vagrant 1.7K Jan 31 04:28 passthrough.example.com.key
-rw-rw-r-- 1 vagrant vagrant  948 Jan 31 04:28 passthrough.example.com.csr
-rw-rw-r-- 1 vagrant vagrant 1.1K Jan 31 04:28 passthrough.example.com.crt
-rw-rw-r-- 1 vagrant vagrant 1.7K Jan 31 04:38 tls-passthrough.yaml
drwxrwxr-x 1 vagrant vagrant 4.0K Jan 31 05:38 after_tlspassthrough
[Fri Jan 31 06:16:20] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway]#
[Fri Jan 31 06:16:20] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway]#
ll
total 16K
-rw-rw-r-- 1 vagrant vagrant  290 Jan 29 03:34 kind-config.yaml
-rwxrwxr-x 1 vagrant vagrant 1.7K Jan 29 05:47 capture-envoy-data.sh
drwxrwxr-x 1 vagrant vagrant 4.0K Jan 31 05:17 HTTPRoute
drwxrwxr-x 1 vagrant vagrant 4.0K Jan 31 05:38 TLS-Passthrough
[Fri Jan 31 06:16:26] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway]#
ls
HTTPRoute  TLS-Passthrough  capture-envoy-data.sh  kind-config.yaml
[Fri Jan 31 06:18:45] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway]#
k get tcproutes.gateway.networking.k8s.io
No resources found in default namespace.
[Fri Jan 31 06:21:34] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway]#
k get crds
NAME                                           CREATED AT
backendlbpolicies.gateway.networking.k8s.io    2025-01-31T05:09:26Z
backends.gateway.envoyproxy.io                 2025-01-31T05:09:27Z
backendtlspolicies.gateway.networking.k8s.io   2025-01-31T05:09:26Z
backendtrafficpolicies.gateway.envoyproxy.io   2025-01-31T05:09:27Z
clienttrafficpolicies.gateway.envoyproxy.io    2025-01-31T05:09:27Z
envoyextensionpolicies.gateway.envoyproxy.io   2025-01-31T05:09:27Z
envoypatchpolicies.gateway.envoyproxy.io       2025-01-31T05:09:27Z
envoyproxies.gateway.envoyproxy.io             2025-01-31T05:09:27Z
gatewayclasses.gateway.networking.k8s.io       2025-01-31T05:09:26Z
gateways.gateway.networking.k8s.io             2025-01-31T05:09:26Z
grpcroutes.gateway.networking.k8s.io           2025-01-31T05:09:26Z
httproutefilters.gateway.envoyproxy.io         2025-01-31T05:09:28Z
httproutes.gateway.networking.k8s.io           2025-01-31T05:09:26Z
referencegrants.gateway.networking.k8s.io      2025-01-31T05:09:26Z
securitypolicies.gateway.envoyproxy.io         2025-01-31T05:09:28Z
tcproutes.gateway.networking.k8s.io            2025-01-31T05:09:26Z
tlsroutes.gateway.networking.k8s.io            2025-01-31T05:09:26Z
udproutes.gateway.networking.k8s.io            2025-01-31T05:09:26Z
[Fri Jan 31 06:21:42] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway]#
[Fri Jan 31 06:21:42] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway]#
ll
total 16K
-rw-rw-r-- 1 vagrant vagrant  290 Jan 29 03:34 kind-config.yaml
-rwxrwxr-x 1 vagrant vagrant 1.7K Jan 29 05:47 capture-envoy-data.sh
drwxrwxr-x 1 vagrant vagrant 4.0K Jan 31 05:17 HTTPRoute
drwxrwxr-x 1 vagrant vagrant 4.0K Jan 31 05:38 TLS-Passthrough
[Fri Jan 31 06:22:17] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway]#
[Fri Jan 31 06:32:57] [vagrant@ubuntu-jammy] [/shared-with-host/envoy-gateway]#














































